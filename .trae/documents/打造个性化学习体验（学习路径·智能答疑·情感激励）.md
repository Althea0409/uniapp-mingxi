## 总体目标

* 在现有页面与数据基础上，补充“个性化学习路径、智能答疑、情感陪伴与激励”的闭环能力，保持 UI 风格统一、交互顺畅、数据来源稳定（全部走 `src/mock`）。

## 数据与架构

* 统一数据来源：Portrait/Plan/Courses/Homework/Achievements/Encouragement 已在 `src/mock`；补充可选 `schedule.json`（若需要课表更细）。

* 读写约束：所有页面只读 mock；写入用户行为到 `storage`（学习时长、连续错题、积分）。

* Store 扩展：在 `appStore` 中提供触发激励、学习行为记录、晚间打卡；在 `userStore` 中承接积分变更。

## 个性化学习路径

* 画像驱动任务生成：

  * 从 `portrait.json` 读取当前学科的掌握度条目（<=75 为薄弱项）。

  * 生成 3～5 个“专项巩固”任务（标题、预计时长、难度、资源标签）。

  * 与 `plan.json` 的兜底任务合并去重，按学科切换即时刷新。

* 任务联动：

  * 点击“开始”跳转到学习页对应模块（题库/视频/错题本）。

  * 完成后：积分+20、弹出庆祝型激励，将完成记录入“成长档案”（后续页）。

* 涉及文件：`src/pages/plan/index.vue`（生成函数与 UI）、`src/mock/portrait.json`、`src/mock/plan.json`。

## 智能答疑

* 意图识别增强（纯前端）：根据关键词路由到不同数据输出模板：

  * 课程/课表 → `courses.json`

  * 作业/成绩 → `homework.json`

  * 预习 → `homework.json.preview`

  * 资源推荐/讨论热点 → `achievements.json.resources/discussions`

* 流式输出：保持已实现的字符级延时；模板返回结构化要点（标题+列表），语气友好、分点清晰。

* 涉及文件：`src/services/ai.ts`（mock 响应增强）、`src/pages/assistant/index.vue`（输入条上移与空间留白）。

## 情感陪伴与激励

* 触发策略：

  * 学习时长：单次≥60分钟或当日累计≥120分钟 → 疲劳型提醒（建议休息/拉伸）。

  * 连续错题：≥3次 → 鼓励型提醒（给出小建议/正向反馈）。

  * 晚间打卡：≥21点 → 晚安型提醒（温情陪伴）。

* 文案来源：`encouragement.json`；弹窗使用现有 `PopupEncourage`。

* 涉及文件：`src/stores/app.ts`（记录与触发方法）、学习页入口轻触发 `recordStudySession`。

## 课后作业与预习

* 学习页统一读取 `courses.json/homework.json` 并映射到 UI；筛选交互保持。

* 详情页（后续）：支持“提交作业/预习完成”写入档案与积分。

* 涉及文件：`src/pages/study/index.vue`（JSON 接入与行为记录）。

## 资源推荐与讨论

* 发现页/助手内展示资源推荐条目（标题、匹配度、简述、时长/评分可选）。

* 讨论热点：展示小组、标题、回复数、热度；引导参与以提升课堂互动。

## 验证与交付

* 本地 H5 运行检查：导航顺序、图标选中态、助手输入条位置、紫色头图高度、学习路径按学科切换生成是否正确。

* 用 6 组提问测试智能答疑意图（课程/作业/预习/资源/讨论/成绩）。

* 在学习页点击“开始/完成”验证积分与激励弹窗。

## 扩展（可选）

* 新增“成长档案”页，列表化展示任务完成、积分变更、激励触发日志（读写 localStorage）。

* 为路径任务添加“推荐原因”，来源于画像薄弱项的命中规则。

请确认以上计划。确认后我将开始逐项落实，并做端到端验证。
